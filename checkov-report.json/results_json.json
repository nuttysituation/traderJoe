{"check_type": "dockerfile", "results": {"passed_checks": [{"check_id": "CKV_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_9", "check_name": "Ensure From Alias are unique for multistage builds.", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM node:18-alpine\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"], [7, "\n"], [8, "WORKDIR /app\n"], [9, "\n"], [10, "# Copy package files\n"], [11, "COPY package*.json ./\n"], [12, "\n"], [13, "# Install all dependencies (including dev dependencies for development)\n"], [14, "RUN npm ci --only=production && npm cache clean --force\n"], [15, "\n"], [16, "# Copy source code\n"], [17, "COPY . .\n"], [18, "\n"], [19, "# Create necessary directories with proper permissions\n"], [20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"], [22, "\n"], [23, "# Switch to non-root user\n"], [24, "USER nodejs\n"], [25, "\n"], [26, "# Expose ports\n"], [27, "EXPOSE 3001\n"], [28, "\n"], [29, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [30, "  CMD node healthcheck.js\n"], [31, "\n"], [32, "# Start the application in development mode\n"], [33, "CMD [\"npm\", \"run\", \"dev\"] "]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [1, 33], "resource": "/server/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.AliasIsUnique", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_7", "bc_check_id": "BC_DKR_7", "check_name": "Ensure the base image uses a non latest version tag", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "FROM", "startline": 0, "endline": 0, "content": "FROM node:18-alpine\n", "value": "node:18-alpine"}]}, "code_block": [[1, "FROM node:18-alpine\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [1, 1], "resource": "/server/Dockerfile.FROM", "evaluations": null, "check_class": "checkov.dockerfile.checks.ReferenceLatestTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_5", "bc_check_id": "BC_DKR_4", "check_name": "Ensure update instructions are not use alone in the Dockerfile", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM node:18-alpine\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"], [7, "\n"], [8, "WORKDIR /app\n"], [9, "\n"], [10, "# Copy package files\n"], [11, "COPY package*.json ./\n"], [12, "\n"], [13, "# Install all dependencies (including dev dependencies for development)\n"], [14, "RUN npm ci --only=production && npm cache clean --force\n"], [15, "\n"], [16, "# Copy source code\n"], [17, "COPY . .\n"], [18, "\n"], [19, "# Create necessary directories with proper permissions\n"], [20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"], [22, "\n"], [23, "# Switch to non-root user\n"], [24, "USER nodejs\n"], [25, "\n"], [26, "# Expose ports\n"], [27, "EXPOSE 3001\n"], [28, "\n"], [29, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [30, "  CMD node healthcheck.js\n"], [31, "\n"], [32, "# Start the application in development mode\n"], [33, "CMD [\"npm\", \"run\", \"dev\"] "]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [1, 33], "resource": "/server/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UpdateNotAlone", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-update-instructions-are-not-used-alone-in-the-dockerfile", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_9", "bc_check_id": "BC_DKR_NETWORKING_1", "check_name": "Ensure that APT isn't used", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM node:18-alpine\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"], [7, "\n"], [8, "WORKDIR /app\n"], [9, "\n"], [10, "# Copy package files\n"], [11, "COPY package*.json ./\n"], [12, "\n"], [13, "# Install all dependencies (including dev dependencies for development)\n"], [14, "RUN npm ci --only=production && npm cache clean --force\n"], [15, "\n"], [16, "# Copy source code\n"], [17, "COPY . .\n"], [18, "\n"], [19, "# Create necessary directories with proper permissions\n"], [20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"], [22, "\n"], [23, "# Switch to non-root user\n"], [24, "USER nodejs\n"], [25, "\n"], [26, "# Expose ports\n"], [27, "EXPOSE 3001\n"], [28, "\n"], [29, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [30, "  CMD node healthcheck.js\n"], [31, "\n"], [32, "# Start the application in development mode\n"], [33, "CMD [\"npm\", \"run\", \"dev\"] "]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [1, 33], "resource": "/server/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.RunUsingAPT", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-is-not-used", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_10", "check_name": "Ensure that WORKDIR values are absolute paths", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM node:18-alpine\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"], [7, "\n"], [8, "WORKDIR /app\n"], [9, "\n"], [10, "# Copy package files\n"], [11, "COPY package*.json ./\n"], [12, "\n"], [13, "# Install all dependencies (including dev dependencies for development)\n"], [14, "RUN npm ci --only=production && npm cache clean --force\n"], [15, "\n"], [16, "# Copy source code\n"], [17, "COPY . .\n"], [18, "\n"], [19, "# Create necessary directories with proper permissions\n"], [20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"], [22, "\n"], [23, "# Switch to non-root user\n"], [24, "USER nodejs\n"], [25, "\n"], [26, "# Expose ports\n"], [27, "EXPOSE 3001\n"], [28, "\n"], [29, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [30, "  CMD node healthcheck.js\n"], [31, "\n"], [32, "# Start the application in development mode\n"], [33, "CMD [\"npm\", \"run\", \"dev\"] "]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [1, 33], "resource": "/server/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.WorkdirIsAbsolute", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-workdir-values-are-absolute-paths", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_8", "bc_check_id": "BC_DKR_8", "check_name": "Ensure the last USER is not root", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 23, "endline": 23, "content": "USER nodejs\n", "value": "nodejs"}]}, "code_block": [[24, "USER nodejs\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [24, 24], "resource": "/server/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.RootUser", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-last-user-is-not-root", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_1", "bc_check_id": "BC_DKR_1", "check_name": "Ensure port 22 is not exposed", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM node:18-alpine\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"], [7, "\n"], [8, "WORKDIR /app\n"], [9, "\n"], [10, "# Copy package files\n"], [11, "COPY package*.json ./\n"], [12, "\n"], [13, "# Install all dependencies (including dev dependencies for development)\n"], [14, "RUN npm ci --only=production && npm cache clean --force\n"], [15, "\n"], [16, "# Copy source code\n"], [17, "COPY . .\n"], [18, "\n"], [19, "# Create necessary directories with proper permissions\n"], [20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"], [22, "\n"], [23, "# Switch to non-root user\n"], [24, "USER nodejs\n"], [25, "\n"], [26, "# Expose ports\n"], [27, "EXPOSE 3001\n"], [28, "\n"], [29, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [30, "  CMD node healthcheck.js\n"], [31, "\n"], [32, "# Start the application in development mode\n"], [33, "CMD [\"npm\", \"run\", \"dev\"] "]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [1, 33], "resource": "/server/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.ExposePort22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-port-22-is-not-exposed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "HEALTHCHECK", "startline": 28, "endline": 29, "content": "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n  CMD node healthcheck.js\n", "value": "--interval=30s --timeout=3s --start-period=5s --retries=3   CMD node healthcheck.js"}]}, "code_block": [[29, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [30, "  CMD node healthcheck.js\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [29, 30], "resource": "/server/Dockerfile.HEALTHCHECK", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 23, "endline": 23, "content": "USER nodejs\n", "value": "nodejs"}]}, "code_block": [[24, "USER nodejs\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [24, 24], "resource": "/server/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_9", "check_name": "Ensure From Alias are unique for multistage builds.", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM node:18-alpine\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"], [7, "\n"], [8, "# Set working directory\n"], [9, "WORKDIR /app\n"], [10, "\n"], [11, "# Copy package files\n"], [12, "COPY package*.json ./\n"], [13, "\n"], [14, "# Install all dependencies (including devDependencies)\n"], [15, "RUN npm ci && npm cache clean --force\n"], [16, "\n"], [17, "# Copy source code\n"], [18, "COPY . .\n"], [19, "\n"], [20, "# Create necessary directories with proper permissions\n"], [21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"], [23, "\n"], [24, "# Switch to non-root user\n"], [25, "USER nodejs\n"], [26, "\n"], [27, "# Expose port\n"], [28, "EXPOSE 3000\n"], [29, "\n"], [30, "# Start the development server\n"], [31, "CMD [\"npm\", \"start\"] "]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [1, 31], "resource": "/client/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.AliasIsUnique", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_7", "bc_check_id": "BC_DKR_7", "check_name": "Ensure the base image uses a non latest version tag", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "FROM", "startline": 0, "endline": 0, "content": "FROM node:18-alpine\n", "value": "node:18-alpine"}]}, "code_block": [[1, "FROM node:18-alpine\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [1, 1], "resource": "/client/Dockerfile.FROM", "evaluations": null, "check_class": "checkov.dockerfile.checks.ReferenceLatestTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_5", "bc_check_id": "BC_DKR_4", "check_name": "Ensure update instructions are not use alone in the Dockerfile", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM node:18-alpine\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"], [7, "\n"], [8, "# Set working directory\n"], [9, "WORKDIR /app\n"], [10, "\n"], [11, "# Copy package files\n"], [12, "COPY package*.json ./\n"], [13, "\n"], [14, "# Install all dependencies (including devDependencies)\n"], [15, "RUN npm ci && npm cache clean --force\n"], [16, "\n"], [17, "# Copy source code\n"], [18, "COPY . .\n"], [19, "\n"], [20, "# Create necessary directories with proper permissions\n"], [21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"], [23, "\n"], [24, "# Switch to non-root user\n"], [25, "USER nodejs\n"], [26, "\n"], [27, "# Expose port\n"], [28, "EXPOSE 3000\n"], [29, "\n"], [30, "# Start the development server\n"], [31, "CMD [\"npm\", \"start\"] "]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [1, 31], "resource": "/client/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UpdateNotAlone", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-update-instructions-are-not-used-alone-in-the-dockerfile", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_9", "bc_check_id": "BC_DKR_NETWORKING_1", "check_name": "Ensure that APT isn't used", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM node:18-alpine\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"], [7, "\n"], [8, "# Set working directory\n"], [9, "WORKDIR /app\n"], [10, "\n"], [11, "# Copy package files\n"], [12, "COPY package*.json ./\n"], [13, "\n"], [14, "# Install all dependencies (including devDependencies)\n"], [15, "RUN npm ci && npm cache clean --force\n"], [16, "\n"], [17, "# Copy source code\n"], [18, "COPY . .\n"], [19, "\n"], [20, "# Create necessary directories with proper permissions\n"], [21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"], [23, "\n"], [24, "# Switch to non-root user\n"], [25, "USER nodejs\n"], [26, "\n"], [27, "# Expose port\n"], [28, "EXPOSE 3000\n"], [29, "\n"], [30, "# Start the development server\n"], [31, "CMD [\"npm\", \"start\"] "]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [1, 31], "resource": "/client/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.RunUsingAPT", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-is-not-used", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_10", "check_name": "Ensure that WORKDIR values are absolute paths", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM node:18-alpine\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"], [7, "\n"], [8, "# Set working directory\n"], [9, "WORKDIR /app\n"], [10, "\n"], [11, "# Copy package files\n"], [12, "COPY package*.json ./\n"], [13, "\n"], [14, "# Install all dependencies (including devDependencies)\n"], [15, "RUN npm ci && npm cache clean --force\n"], [16, "\n"], [17, "# Copy source code\n"], [18, "COPY . .\n"], [19, "\n"], [20, "# Create necessary directories with proper permissions\n"], [21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"], [23, "\n"], [24, "# Switch to non-root user\n"], [25, "USER nodejs\n"], [26, "\n"], [27, "# Expose port\n"], [28, "EXPOSE 3000\n"], [29, "\n"], [30, "# Start the development server\n"], [31, "CMD [\"npm\", \"start\"] "]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [1, 31], "resource": "/client/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.WorkdirIsAbsolute", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-workdir-values-are-absolute-paths", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_8", "bc_check_id": "BC_DKR_8", "check_name": "Ensure the last USER is not root", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 24, "endline": 24, "content": "USER nodejs\n", "value": "nodejs"}]}, "code_block": [[25, "USER nodejs\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [25, 25], "resource": "/client/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.RootUser", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-last-user-is-not-root", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_1", "bc_check_id": "BC_DKR_1", "check_name": "Ensure port 22 is not exposed", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM node:18-alpine\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"], [7, "\n"], [8, "# Set working directory\n"], [9, "WORKDIR /app\n"], [10, "\n"], [11, "# Copy package files\n"], [12, "COPY package*.json ./\n"], [13, "\n"], [14, "# Install all dependencies (including devDependencies)\n"], [15, "RUN npm ci && npm cache clean --force\n"], [16, "\n"], [17, "# Copy source code\n"], [18, "COPY . .\n"], [19, "\n"], [20, "# Create necessary directories with proper permissions\n"], [21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"], [23, "\n"], [24, "# Switch to non-root user\n"], [25, "USER nodejs\n"], [26, "\n"], [27, "# Expose port\n"], [28, "EXPOSE 3000\n"], [29, "\n"], [30, "# Start the development server\n"], [31, "CMD [\"npm\", \"start\"] "]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [1, 31], "resource": "/client/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.ExposePort22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-port-22-is-not-exposed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 24, "endline": 24, "content": "USER nodejs\n", "value": "nodejs"}]}, "code_block": [[25, "USER nodejs\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [25, 25], "resource": "/client/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_9", "check_name": "Ensure From Alias are unique for multistage builds.", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM python:3.11-slim\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"], [7, "\n"], [8, "# Set working directory\n"], [9, "WORKDIR /app\n"], [10, "\n"], [11, "# Install system dependencies\n"], [12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"], [16, "\n"], [17, "# Copy requirements first for better caching\n"], [18, "COPY requirements.txt .\n"], [19, "\n"], [20, "# Install Python dependencies\n"], [21, "RUN pip install --no-cache-dir -r requirements.txt\n"], [22, "\n"], [23, "# Copy source code\n"], [24, "COPY . .\n"], [25, "\n"], [26, "# Create necessary directories with proper permissions\n"], [27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"], [29, "\n"], [30, "# Switch to non-root user\n"], [31, "USER pythonuser\n"], [32, "\n"], [33, "# Expose port\n"], [34, "EXPOSE 5000\n"], [35, "\n"], [36, "# Health check\n"], [37, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [38, "  CMD curl -f http://localhost:5000/health || exit 1\n"], [39, "\n"], [40, "# Start the application\n"], [41, "CMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\", \"--reload\"] "]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [1, 41], "resource": "/ai-service/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.AliasIsUnique", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_7", "bc_check_id": "BC_DKR_7", "check_name": "Ensure the base image uses a non latest version tag", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "FROM", "startline": 0, "endline": 0, "content": "FROM python:3.11-slim\n", "value": "python:3.11-slim"}]}, "code_block": [[1, "FROM python:3.11-slim\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [1, 1], "resource": "/ai-service/Dockerfile.FROM", "evaluations": null, "check_class": "checkov.dockerfile.checks.ReferenceLatestTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_5", "bc_check_id": "BC_DKR_4", "check_name": "Ensure update instructions are not use alone in the Dockerfile", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM python:3.11-slim\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"], [7, "\n"], [8, "# Set working directory\n"], [9, "WORKDIR /app\n"], [10, "\n"], [11, "# Install system dependencies\n"], [12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"], [16, "\n"], [17, "# Copy requirements first for better caching\n"], [18, "COPY requirements.txt .\n"], [19, "\n"], [20, "# Install Python dependencies\n"], [21, "RUN pip install --no-cache-dir -r requirements.txt\n"], [22, "\n"], [23, "# Copy source code\n"], [24, "COPY . .\n"], [25, "\n"], [26, "# Create necessary directories with proper permissions\n"], [27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"], [29, "\n"], [30, "# Switch to non-root user\n"], [31, "USER pythonuser\n"], [32, "\n"], [33, "# Expose port\n"], [34, "EXPOSE 5000\n"], [35, "\n"], [36, "# Health check\n"], [37, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [38, "  CMD curl -f http://localhost:5000/health || exit 1\n"], [39, "\n"], [40, "# Start the application\n"], [41, "CMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\", \"--reload\"] "]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [1, 41], "resource": "/ai-service/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UpdateNotAlone", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-update-instructions-are-not-used-alone-in-the-dockerfile", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_9", "bc_check_id": "BC_DKR_NETWORKING_1", "check_name": "Ensure that APT isn't used", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM python:3.11-slim\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"], [7, "\n"], [8, "# Set working directory\n"], [9, "WORKDIR /app\n"], [10, "\n"], [11, "# Install system dependencies\n"], [12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"], [16, "\n"], [17, "# Copy requirements first for better caching\n"], [18, "COPY requirements.txt .\n"], [19, "\n"], [20, "# Install Python dependencies\n"], [21, "RUN pip install --no-cache-dir -r requirements.txt\n"], [22, "\n"], [23, "# Copy source code\n"], [24, "COPY . .\n"], [25, "\n"], [26, "# Create necessary directories with proper permissions\n"], [27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"], [29, "\n"], [30, "# Switch to non-root user\n"], [31, "USER pythonuser\n"], [32, "\n"], [33, "# Expose port\n"], [34, "EXPOSE 5000\n"], [35, "\n"], [36, "# Health check\n"], [37, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [38, "  CMD curl -f http://localhost:5000/health || exit 1\n"], [39, "\n"], [40, "# Start the application\n"], [41, "CMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\", \"--reload\"] "]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [1, 41], "resource": "/ai-service/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.RunUsingAPT", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-is-not-used", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_10", "check_name": "Ensure that WORKDIR values are absolute paths", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM python:3.11-slim\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"], [7, "\n"], [8, "# Set working directory\n"], [9, "WORKDIR /app\n"], [10, "\n"], [11, "# Install system dependencies\n"], [12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"], [16, "\n"], [17, "# Copy requirements first for better caching\n"], [18, "COPY requirements.txt .\n"], [19, "\n"], [20, "# Install Python dependencies\n"], [21, "RUN pip install --no-cache-dir -r requirements.txt\n"], [22, "\n"], [23, "# Copy source code\n"], [24, "COPY . .\n"], [25, "\n"], [26, "# Create necessary directories with proper permissions\n"], [27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"], [29, "\n"], [30, "# Switch to non-root user\n"], [31, "USER pythonuser\n"], [32, "\n"], [33, "# Expose port\n"], [34, "EXPOSE 5000\n"], [35, "\n"], [36, "# Health check\n"], [37, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [38, "  CMD curl -f http://localhost:5000/health || exit 1\n"], [39, "\n"], [40, "# Start the application\n"], [41, "CMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\", \"--reload\"] "]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [1, 41], "resource": "/ai-service/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.WorkdirIsAbsolute", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-workdir-values-are-absolute-paths", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_8", "bc_check_id": "BC_DKR_8", "check_name": "Ensure the last USER is not root", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 30, "endline": 30, "content": "USER pythonuser\n", "value": "pythonuser"}]}, "code_block": [[31, "USER pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [31, 31], "resource": "/ai-service/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.RootUser", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-last-user-is-not-root", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_1", "bc_check_id": "BC_DKR_1", "check_name": "Ensure port 22 is not exposed", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM python:3.11-slim\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"], [7, "\n"], [8, "# Set working directory\n"], [9, "WORKDIR /app\n"], [10, "\n"], [11, "# Install system dependencies\n"], [12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"], [16, "\n"], [17, "# Copy requirements first for better caching\n"], [18, "COPY requirements.txt .\n"], [19, "\n"], [20, "# Install Python dependencies\n"], [21, "RUN pip install --no-cache-dir -r requirements.txt\n"], [22, "\n"], [23, "# Copy source code\n"], [24, "COPY . .\n"], [25, "\n"], [26, "# Create necessary directories with proper permissions\n"], [27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"], [29, "\n"], [30, "# Switch to non-root user\n"], [31, "USER pythonuser\n"], [32, "\n"], [33, "# Expose port\n"], [34, "EXPOSE 5000\n"], [35, "\n"], [36, "# Health check\n"], [37, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [38, "  CMD curl -f http://localhost:5000/health || exit 1\n"], [39, "\n"], [40, "# Start the application\n"], [41, "CMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\", \"--reload\"] "]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [1, 41], "resource": "/ai-service/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.ExposePort22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-port-22-is-not-exposed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "HEALTHCHECK", "startline": 36, "endline": 37, "content": "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n  CMD curl -f http://localhost:5000/health || exit 1\n", "value": "--interval=30s --timeout=3s --start-period=5s --retries=3   CMD curl -f http://localhost:5000/health || exit 1"}]}, "code_block": [[37, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [38, "  CMD curl -f http://localhost:5000/health || exit 1\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [37, 38], "resource": "/ai-service/Dockerfile.HEALTHCHECK", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 30, "endline": 30, "content": "USER pythonuser\n", "value": "pythonuser"}]}, "code_block": [[31, "USER pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [31, 31], "resource": "/ai-service/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_9", "check_name": "Ensure From Alias are unique for multistage builds.", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Multi-stage build for production\n"], [2, "FROM node:18-alpine AS base\n"], [3, "\n"], [4, "# Install security updates and create non-root user\n"], [5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"], [8, "\n"], [9, "# Set working directory\n"], [10, "WORKDIR /app\n"], [11, "\n"], [12, "# Copy package files\n"], [13, "COPY package*.json ./\n"], [14, "\n"], [15, "# Install dependencies\n"], [16, "RUN npm ci --only=production && npm cache clean --force\n"], [17, "\n"], [18, "# Copy source code\n"], [19, "COPY . .\n"], [20, "\n"], [21, "# Create necessary directories with proper permissions\n"], [22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"], [24, "\n"], [25, "# Switch to non-root user\n"], [26, "USER nodejs\n"], [27, "\n"], [28, "# Expose port\n"], [29, "EXPOSE 3001\n"], [30, "\n"], [31, "# Health check\n"], [32, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [33, "  CMD node healthcheck.js\n"], [34, "\n"], [35, "# Start the application\n"], [36, "CMD [\"npm\", \"start\"] "]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [1, 36], "resource": "/Dockerfile.production.", "evaluations": null, "check_class": "checkov.dockerfile.checks.AliasIsUnique", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_7", "bc_check_id": "BC_DKR_7", "check_name": "Ensure the base image uses a non latest version tag", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "FROM", "startline": 1, "endline": 1, "content": "FROM node:18-alpine AS base\n", "value": "node:18-alpine AS base"}]}, "code_block": [[2, "FROM node:18-alpine AS base\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [2, 2], "resource": "/Dockerfile.production.FROM", "evaluations": null, "check_class": "checkov.dockerfile.checks.ReferenceLatestTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_5", "bc_check_id": "BC_DKR_4", "check_name": "Ensure update instructions are not use alone in the Dockerfile", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Multi-stage build for production\n"], [2, "FROM node:18-alpine AS base\n"], [3, "\n"], [4, "# Install security updates and create non-root user\n"], [5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"], [8, "\n"], [9, "# Set working directory\n"], [10, "WORKDIR /app\n"], [11, "\n"], [12, "# Copy package files\n"], [13, "COPY package*.json ./\n"], [14, "\n"], [15, "# Install dependencies\n"], [16, "RUN npm ci --only=production && npm cache clean --force\n"], [17, "\n"], [18, "# Copy source code\n"], [19, "COPY . .\n"], [20, "\n"], [21, "# Create necessary directories with proper permissions\n"], [22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"], [24, "\n"], [25, "# Switch to non-root user\n"], [26, "USER nodejs\n"], [27, "\n"], [28, "# Expose port\n"], [29, "EXPOSE 3001\n"], [30, "\n"], [31, "# Health check\n"], [32, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [33, "  CMD node healthcheck.js\n"], [34, "\n"], [35, "# Start the application\n"], [36, "CMD [\"npm\", \"start\"] "]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [1, 36], "resource": "/Dockerfile.production.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UpdateNotAlone", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-update-instructions-are-not-used-alone-in-the-dockerfile", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_9", "bc_check_id": "BC_DKR_NETWORKING_1", "check_name": "Ensure that APT isn't used", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Multi-stage build for production\n"], [2, "FROM node:18-alpine AS base\n"], [3, "\n"], [4, "# Install security updates and create non-root user\n"], [5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"], [8, "\n"], [9, "# Set working directory\n"], [10, "WORKDIR /app\n"], [11, "\n"], [12, "# Copy package files\n"], [13, "COPY package*.json ./\n"], [14, "\n"], [15, "# Install dependencies\n"], [16, "RUN npm ci --only=production && npm cache clean --force\n"], [17, "\n"], [18, "# Copy source code\n"], [19, "COPY . .\n"], [20, "\n"], [21, "# Create necessary directories with proper permissions\n"], [22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"], [24, "\n"], [25, "# Switch to non-root user\n"], [26, "USER nodejs\n"], [27, "\n"], [28, "# Expose port\n"], [29, "EXPOSE 3001\n"], [30, "\n"], [31, "# Health check\n"], [32, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [33, "  CMD node healthcheck.js\n"], [34, "\n"], [35, "# Start the application\n"], [36, "CMD [\"npm\", \"start\"] "]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [1, 36], "resource": "/Dockerfile.production.", "evaluations": null, "check_class": "checkov.dockerfile.checks.RunUsingAPT", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-is-not-used", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_10", "check_name": "Ensure that WORKDIR values are absolute paths", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Multi-stage build for production\n"], [2, "FROM node:18-alpine AS base\n"], [3, "\n"], [4, "# Install security updates and create non-root user\n"], [5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"], [8, "\n"], [9, "# Set working directory\n"], [10, "WORKDIR /app\n"], [11, "\n"], [12, "# Copy package files\n"], [13, "COPY package*.json ./\n"], [14, "\n"], [15, "# Install dependencies\n"], [16, "RUN npm ci --only=production && npm cache clean --force\n"], [17, "\n"], [18, "# Copy source code\n"], [19, "COPY . .\n"], [20, "\n"], [21, "# Create necessary directories with proper permissions\n"], [22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"], [24, "\n"], [25, "# Switch to non-root user\n"], [26, "USER nodejs\n"], [27, "\n"], [28, "# Expose port\n"], [29, "EXPOSE 3001\n"], [30, "\n"], [31, "# Health check\n"], [32, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [33, "  CMD node healthcheck.js\n"], [34, "\n"], [35, "# Start the application\n"], [36, "CMD [\"npm\", \"start\"] "]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [1, 36], "resource": "/Dockerfile.production.", "evaluations": null, "check_class": "checkov.dockerfile.checks.WorkdirIsAbsolute", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-workdir-values-are-absolute-paths", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_8", "bc_check_id": "BC_DKR_8", "check_name": "Ensure the last USER is not root", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 25, "endline": 25, "content": "USER nodejs\n", "value": "nodejs"}]}, "code_block": [[26, "USER nodejs\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [26, 26], "resource": "/Dockerfile.production.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.RootUser", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-last-user-is-not-root", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_1", "bc_check_id": "BC_DKR_1", "check_name": "Ensure port 22 is not exposed", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Multi-stage build for production\n"], [2, "FROM node:18-alpine AS base\n"], [3, "\n"], [4, "# Install security updates and create non-root user\n"], [5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"], [8, "\n"], [9, "# Set working directory\n"], [10, "WORKDIR /app\n"], [11, "\n"], [12, "# Copy package files\n"], [13, "COPY package*.json ./\n"], [14, "\n"], [15, "# Install dependencies\n"], [16, "RUN npm ci --only=production && npm cache clean --force\n"], [17, "\n"], [18, "# Copy source code\n"], [19, "COPY . .\n"], [20, "\n"], [21, "# Create necessary directories with proper permissions\n"], [22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"], [24, "\n"], [25, "# Switch to non-root user\n"], [26, "USER nodejs\n"], [27, "\n"], [28, "# Expose port\n"], [29, "EXPOSE 3001\n"], [30, "\n"], [31, "# Health check\n"], [32, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [33, "  CMD node healthcheck.js\n"], [34, "\n"], [35, "# Start the application\n"], [36, "CMD [\"npm\", \"start\"] "]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [1, 36], "resource": "/Dockerfile.production.", "evaluations": null, "check_class": "checkov.dockerfile.checks.ExposePort22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-port-22-is-not-exposed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "HEALTHCHECK", "startline": 31, "endline": 32, "content": "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n  CMD node healthcheck.js\n", "value": "--interval=30s --timeout=3s --start-period=5s --retries=3   CMD node healthcheck.js"}]}, "code_block": [[32, "HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n"], [33, "  CMD node healthcheck.js\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [32, 33], "resource": "/Dockerfile.production.HEALTHCHECK", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 25, "endline": 25, "content": "USER nodejs\n", "value": "nodejs"}]}, "code_block": [[26, "USER nodejs\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [26, 26], "resource": "/Dockerfile.production.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": null, "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": null, "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": null, "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": null, "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": null, "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": null, "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": null, "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": null, "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": null, "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": null, "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": null, "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": null, "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": null, "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": null, "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": null, "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": null, "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": null, "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": null, "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": null, "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": null, "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": null, "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": null, "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": null, "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": null, "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": null, "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": null, "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": null, "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": null, "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": null, "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": null, "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": null, "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": null, "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": null, "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": null, "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": null, "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": null, "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": null, "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": null, "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": null, "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": null, "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": null, "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": null, "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": null, "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": null, "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": null, "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": null, "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": null, "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": null, "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": null, "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": null, "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": null, "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": null, "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": null, "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "e77184bc910f84b9376b69601288361591de0e76d7f09f2290260380512e7ffa"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [4, 6], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 13, "__endline__": 13, "resource_type": "RUN", "hash": "4fef903be045f704b5c88d3cc663e355adb5186b4845f33a89d64c067b4cd95a"}, "evaluated_keys": ["value"]}, "code_block": [[14, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [14, 14], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/server/Dockerfile", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 19, "__endline__": 20, "resource_type": "RUN", "hash": "c12058759e4021bb7cbc28b1f317334a8470b1c2f2ddf047957a5943c2cc5972"}, "evaluated_keys": ["value"]}, "code_block": [[20, "RUN mkdir -p logs ssl && \\\n"], [21, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/server/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/server/Dockerfile", "repo_file_path": "/server/Dockerfile", "file_line_range": [20, 21], "resource": "/server/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "d6eb48a72eb346a5d1dce4ef3594848ca5b3d0db956b9ea82cf15a7faf11706b"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [4, 6], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci && npm cache clean --force\n", "value": "npm ci && npm cache clean --force", "__startline__": 14, "__endline__": 14, "resource_type": "RUN", "hash": "2e4c4ece562035e16a5c150377bfc645ea7c85affde1549cc24548d3433f50be"}, "evaluated_keys": ["value"]}, "code_block": [[15, "RUN npm ci && npm cache clean --force\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [15, 15], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/client/Dockerfile", "config_": {"content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p ssl &&     chown -R nodejs:nodejs /app", "__startline__": 20, "__endline__": 21, "resource_type": "RUN", "hash": "ac73c93818f4c8044c2760cfe09ea0bd7e58661baad6378a2b0e3db15e518b92"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [21, 22], "resource": "/client/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get upgrade -y && \\\n    groupadd -g 1001 pythonuser && \\\n    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n", "value": "apt-get update && apt-get upgrade -y &&     groupadd -g 1001 pythonuser &&     useradd -u 1001 -g pythonuser -s /bin/bash pythonuser", "__startline__": 3, "__endline__": 5, "resource_type": "RUN", "hash": "08a5d71af84716ac18e0a94777d0ba328d8d40177eef7fa9f3cb8c74e5c0abc7"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apt-get update && apt-get upgrade -y && \\\n"], [5, "    groupadd -g 1001 pythonuser && \\\n"], [6, "    useradd -u 1001 -g pythonuser -s /bin/bash pythonuser\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [4, 6], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && apt-get install -y \\\n    gcc \\\n    g++ \\\n    && rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update && apt-get install -y     gcc     g++     && rm -rf /var/lib/apt/lists/*", "__startline__": 11, "__endline__": 14, "resource_type": "RUN", "hash": "2e706afb7cdfdbfc56fe52b4c578aa7edec87480bd3b4499d4f13adee3ccabb1"}, "evaluated_keys": ["value"]}, "code_block": [[12, "RUN apt-get update && apt-get install -y \\\n"], [13, "    gcc \\\n"], [14, "    g++ \\\n"], [15, "    && rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [12, 15], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir -r requirements.txt", "__startline__": 20, "__endline__": 20, "resource_type": "RUN", "hash": "14943f6b48580a5dd037843c1997ba3008afbeeacf8da2da214166b2bc27a78e"}, "evaluated_keys": ["value"]}, "code_block": [[21, "RUN pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [21, 21], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/ai-service/Dockerfile", "config_": {"content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs && \\\n    chown -R pythonuser:pythonuser /app\n", "value": "mkdir -p logs &&     chown -R pythonuser:pythonuser /app", "__startline__": 26, "__endline__": 27, "resource_type": "RUN", "hash": "a86ff2bb1c0798ae668c1593266784fadc9b1aec3f8e039cf9093efe4d7db715"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN mkdir -p logs && \\\n"], [28, "    chown -R pythonuser:pythonuser /app\n"]], "file_path": "/ai-service/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/ai-service/Dockerfile", "repo_file_path": "/ai-service/Dockerfile", "file_line_range": [27, 28], "resource": "/ai-service/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade && \\\n    addgroup -g 1001 -S nodejs && \\\n    adduser -S nodejs -u 1001\n", "value": "apk update && apk upgrade &&     addgroup -g 1001 -S nodejs &&     adduser -S nodejs -u 1001", "__startline__": 4, "__endline__": 6, "resource_type": "RUN", "hash": "c62089ce7d88ee28bb24a6cc83a97d9b43fa95c6828bbca7a536e01533665274"}, "evaluated_keys": ["value"]}, "code_block": [[5, "RUN apk update && apk upgrade && \\\n"], [6, "    addgroup -g 1001 -S nodejs && \\\n"], [7, "    adduser -S nodejs -u 1001\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [5, 7], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN npm ci --only=production && npm cache clean --force\n", "value": "npm ci --only=production && npm cache clean --force", "__startline__": 15, "__endline__": 15, "resource_type": "RUN", "hash": "ecd79ea84822aef531cc562adfc0d991ed7b6679cf20d70bc91b87a46de35581"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN npm ci --only=production && npm cache clean --force\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [16, 16], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": null, "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile.production", "config_": {"content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p logs ssl && \\\n    chown -R nodejs:nodejs /app\n", "value": "mkdir -p logs ssl &&     chown -R nodejs:nodejs /app", "__startline__": 21, "__endline__": 22, "resource_type": "RUN", "hash": "bf503e6a300c3ea880b4731dec6193c39024c7cb2baef511fdd13c5d7a0f1d91"}, "evaluated_keys": ["value"]}, "code_block": [[22, "RUN mkdir -p logs ssl && \\\n"], [23, "    chown -R nodejs:nodejs /app\n"]], "file_path": "/Dockerfile.production", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/Dockerfile.production", "repo_file_path": "/Dockerfile.production", "file_line_range": [22, 23], "resource": "/Dockerfile.production.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}], "failed_checks": [{"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "FAILED", "results_configuration": null}, "code_block": [[1, "FROM node:18-alpine\n"], [2, "\n"], [3, "# Install security updates and create non-root user\n"], [4, "RUN apk update && apk upgrade && \\\n"], [5, "    addgroup -g 1001 -S nodejs && \\\n"], [6, "    adduser -S nodejs -u 1001\n"], [7, "\n"], [8, "# Set working directory\n"], [9, "WORKDIR /app\n"], [10, "\n"], [11, "# Copy package files\n"], [12, "COPY package*.json ./\n"], [13, "\n"], [14, "# Install all dependencies (including devDependencies)\n"], [15, "RUN npm ci && npm cache clean --force\n"], [16, "\n"], [17, "# Copy source code\n"], [18, "COPY . .\n"], [19, "\n"], [20, "# Create necessary directories with proper permissions\n"], [21, "RUN mkdir -p ssl && \\\n"], [22, "    chown -R nodejs:nodejs /app\n"], [23, "\n"], [24, "# Switch to non-root user\n"], [25, "USER nodejs\n"], [26, "\n"], [27, "# Expose port\n"], [28, "EXPOSE 3000\n"], [29, "\n"], [30, "# Start the development server\n"], [31, "CMD [\"npm\", \"start\"] "]], "file_path": "/client/Dockerfile", "file_abs_path": "/Users/joe-legit/Cursor Projects/Test App/client/Dockerfile", "repo_file_path": "/client/Dockerfile", "file_line_range": [1, 31], "resource": "/client/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 256, "failed": 1, "skipped": 0, "parsing_errors": 0, "resource_count": 4, "checkov_version": "3.2.447"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}